package com.supergenius.web.finance.helper;

import java.util.ArrayList;
import java.util.Comparator;
import java.util.List;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;

import com.genius.model.base.entity.Pager;
import com.genius.model.base.enums.EStatus;
import com.genius.server.base.helper.BaseHP;
import com.supergenius.global.conf.SysConf;
import com.supergenius.xo.common.constants.MapperDict;
import com.supergenius.xo.finance.entity.Article;
import com.supergenius.xo.finance.service.ArticleSO;

public class IndexHelper extends BaseHP {

	@Autowired
	private static ArticleSO so;
	
	public static ArticleSO getSO() {
		if (so == null) {
			so = (ArticleSO) spring.getBean(ArticleSO.class);
		}
		return so;
	}

//	public static List<Article> getArticleList(String uid) {
//		
//	       return  getSO().getListByUid(uid);
//	          
//	}
//	
	/**
	 * 获取他的主页文章
	 * 
	 * @param u
	 * @param pagenum
	 * @param pagesize
	 * @param model
	 * @param request
	 * @return
	 * @author loupengyu
	 * @date 2018年1月3日17:33:42
	 */
	public static List<Article> getArticleList(String uid, int pagenum, int pagesize) {
		if (pagenum <= 0) {
			pagenum = 1;
		}
		Map<String, Object> map = getParamMap(Pager.getNewInstance(pagenum, pagesize));
		map.put(MapperDict.authoruid, uid);
		map.put(MapperDict.type, EStatus.enable);
		List<Article> list = getSO().getList(map);
		for (Article article : list) {
			if (article != null) {
				IndexHP.setSummary(article);
			}
		}
		IndexHP.initArticleList(list);
		return list;
	}
	
	/**
	 * 获取他的主页热门文章
	 * 
	 * @param u
	 * @param pagenum
	 * @param pagesize
	 * @param model
	 * @param request
	 * @return
	 * @author loupengyu
	 * @date 2018年1月3日17:58:44
	 */
	public static List<Article> gethisHotArticle(String uid) {
		List<Article> result = new ArrayList<>();
		Map<String, Object> map = getParamMap();
		map.put(MapperDict.authoruid, uid);
		map.put(MapperDict.type, EStatus.enable);
		List<Article> list = getSO().getList(map);
		IndexHP.initArticleList(list);
		list.sort(COMPARATOR);
		for (Article article : list) {
			result.add(article);
			if (result.size() >= SysConf.HisArticleSize) {
				break;
			}
		}
		return result;
	}

	private static final Comparator<Article> COMPARATOR = new Comparator<Article>() {
		public int compare(Article o1, Article o2) {
			return o1.compareTo(o2);// 运用Article类的compareTo方法比较两个对象
		}
	};
}
