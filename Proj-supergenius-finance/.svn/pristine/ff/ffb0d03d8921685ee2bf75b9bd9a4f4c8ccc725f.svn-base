[#ftl]
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>${title!'投稿'}</title>
<link href="${basecss}/css/default/pages/contribute11.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="${basejs}/js/libs/validator-1.0.0.js"></script>
<script src="http://open.web.meitu.com/sources/xiuxiu.js" type="text/javascript"></script>
<script type="text/javascript" src="${basejs}/ckeditor/ckeditor.js"></script>
<script type="text/javascript">
	function showXiuXiu(){
	  /*第1个参数是加载编辑器div容器，第2个参数是编辑器类型，第3个参数是div容器宽，第4个参数是div容器高*/
	  xiuxiu.setLaunchVars("uploadBtnLabel", "上传");
	  xiuxiu.setLaunchVars("titleVisible", "0");
	  xiuxiu.setLaunchVars("cropPresets", "4:3");
	  xiuxiu.setLaunchVars("customMenu", ["edit"]);
	  xiuxiu.embedSWF("altcontent",1,"100%","400px");
	  xiuxiu.setUploadURL("${base}/uploadimg/contribute");//修改为您自己的图片上传接口
	  xiuxiu.setUploadType(2);
	  xiuxiu.setUploadDataFieldName("fileimg");
	  xiuxiu.onInit = function (){
	    xiuxiu.loadPhoto("");//默认待处理图片
	  }
	  xiuxiu.onUploadResponse = function (data){
	    $("#imgbox").html("<span id='altcontent'></span>");
	    $("#contributeimg").val(data);
	    var origin = data.split(",")[3];
	    $("#imgshow").removeClass("hd");
	    $("#imgshow_big").attr("src",'${webimg}' + origin)
	  }
	  xiuxiu.onClose = function (){
  		$("#imgbox").html("<span id='altcontent'></span>");
	  }
	}
	
	function avatarXiuXiu(){
		xiuxiu.embedSWF("altavatar",5,"100%","400px");/*第1个参数是加载编辑器div容器，第2个参数是编辑器类型，第3个参数是div容器宽，第4个参数是div容器高*/
		xiuxiu.setUploadURL("${base}/uploadimg/avatar");//修改为您自己的图片上传接口
        xiuxiu.setUploadType(2);
        xiuxiu.setUploadDataFieldName("fileimg");
		xiuxiu.onInit = function (){
			xiuxiu.loadPhoto("");
		}	
		xiuxiu.onUploadResponse = function (data){
			$("#avatarbox").html("<span id='altavatar'></span>");
			$("#avatarimg").val(data);
			var origin = data.split(",")[0];
			$("#avatarshow").removeClass("hd");
			$("#avatarshow_big").attr("src",'${webimg}' + origin)
		}
		xiuxiu.onClose = function (){
	  		$("#avatarbox").html("<span id='altavatar'></span>");
	  }
	}
</script>

<script type="text/javascript">
<!--
$(function(){
	CKEDITOR.replace('content',{
        toolbar : 'MyToolbar',
        filebrowserImageUploadUrl : "${base}/ajax/upload/webdata/contribute",
        filebrowserFlashUploadUrl : "${base}/ckeditor/flash"
    });
});
//-->
</script>
</head>
<body>


<div class="contribute_box" style="width:1000px; margin-bottom:100px;clear:both;">
    <div class="contribute_800" style="padding-bottom:30px">
    <div class="contribute_title">
    <span class="title_1">在线投稿</span>
    </div>
    <span class="title_2">欢迎您投稿！请先查看投稿协议。</span>
    <div class="agree">
        1.“天财评论”的选题范围仅限于财经类、管理类文章，由网站编辑负责审核，审核通过后方可发布，发布成功可获得相应积分。</br>
        2.“天财评论”鼓励有原创观点的文章。原创文章发布成功可获得50-400积分/篇，非原创文章发布可获得1-5积分/篇。积分可用于职业经理人培训学员总监级以下晋级。</br>
        3.本网站不接受“一稿多投”，如果作者在投稿前已经在其它媒体上发表了稿件，本网站有权谢绝发表该稿件。</br>
        4.如果没有明确声明，投稿行为被本网站视为作者已授权本网站对其作品予以商业使用（作者人身权利除外）和转授权的权利，本网站由此获得免费使用，免费授权他人使用及排除他人侵权使用的权利。</br>	
        5.文章只代表作者本人观点，本网站对文章内容不承担任何法律责任。</br>
        6.投稿协议的解释权属于本网站。
    </div>
    <span class="agree_check">
        <input name="ischeckbox" id="checkbox" type="checkbox" checked="false" value="0">
        <label class="agree_check1">我已阅读该规定并同意所有条款</label>
    </span>
    <form id="contribute" class="draft" action="${base}/contribute" method="post" enctype="multipart/form-data">
    	<div id="form">	
    	 [#if !me??]
	    	<div class="title_3">
		    	个人信息<span class="title_3_1" >（会员登录之后可跳过此步骤）</span><a href="javascript:void(0);" class="title_3_a pop-up" id="denglu">点此登录</a>
	    	</div>
	    	<label class="mb_30 w90">姓&nbsp;&nbsp;&nbsp;&nbsp;名<span class="red">*</span></label>
	        <input class="draft_input " type="text" id="txtname" value="${bean.name}" name="name" isnotempty="" placeholder="输入您的姓名"/>
	        <div class="msg-box">
                <div>
	            	<div id="errtxtname" class="msg-weak msg-inline msg-error hd"><i></i><span id="errmsgtxtname"></span></div>
	            	<div id="oktxtname" class="msg-weak msg-inline msg-correct hd"></div>
                </div> 
            </div>
	        <br/>
	    	<label class="mb_30   w90">邮&nbsp;&nbsp;&nbsp;&nbsp;箱<span class="red">*</span></label>
	        <input class="draft_input " type="text" value="${bean.email}" id="txtemail" name="email" isnotempty="" placeholder="输入您的常用邮箱" isemail="" ajaxvalid="${base}/api/user/emailvalid|此邮箱已被使用|请输入163/qq/sina等常用邮箱" maxlength="100"/>
	        <div class="msg-box">
                <div>
	            	<div id="errtxtemail" class="msg-weak msg-inline msg-error hd"><i></i><span id="errmsgtxtemail"></span></div>
	            	<div id="oktxtemail" class="msg-weak msg-inline msg-correct hd"></div>
                </div>
            </div>
	        <br/>
	        
	        <label class="mb_30">头&nbsp;&nbsp;&nbsp;&nbsp;像</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
	        <a id="uploadavatar" href="javascript:avatarXiuXiu()" class="title_3_a">点此上传</a>
	        <div id="avatarbox">
	        	<span id="altavatar"></span>
	        </div>
	        <div class="hd" id="avatarshow" style="margin-left: 165px;">
	        	<img id="avatarshow_big" src='' />
	        </div>
	        <input id="avatarimg" name="avatarimg" type="text" value="" class="hd"/>
	        <br/>
	        
	    	<label class="mb_30  w90" >QQ号码</label>
	        <input  class="draft_input " type="text" value="${bean.qq}" name="qq" placeholder="输入您的QQ号" >
	        <br/>
	    	<label class="mb_30 w90">手机号码</label>
	        <input  class="draft_input " id="txtphone" type="text" value="${bean.phone}" name="phone" placeholder="输入您的手机号" ismobile="" />
	        <div class="msg-box">
                <div>
	            	<div id="errtxtphone" class="msg-weak msg-inline msg-error hd"><i></i><span id="errmsgtxtphone"></span></div>
	            	<div id="oktxtphone" class="msg-weak msg-inline msg-correct hd"></div>
                </div>
            </div>
	        <br/>
	    	<label class="mb_30 w90 titletop ">个人简介<span class="red">*</span></label>
	        <textarea class="draft_input3" id="txtsummary" type="text" name="summary" isnotempty="">${bean.summary}</textarea>
	        <div class="msg-box_topic">
	            <div>
	            	<div id="errtxtsummary" class="msg-weak msg-inline msg-error hd"><i></i><span id="errmsgtxtsummary"></span></div>
	            	<div id="oktxtsummary" class="msg-weak msg-inline msg-correct hd"></div>
	            </div>
	       </div>
    	[/#if]
	        <div class="title_3 ml_12">稿件详情</div>
	    	<label class="mb_30">版块</label>
	    	<span class="draft_select1">
	    	<select name="type">
	    	[#assign typelist = enumstype?keys]
			    	[#list typelist as item]
			    		<option value="${item}">${enumstype[item]}</option>
				    [/#list]
	    		</select>
	    	</span>
	    	<br/> 
	    	<label class="mb_30">文章标题<span class="red">*</span></label>
	        <input class="draft_input ml_35" type="text" id="txttitle" name="title" isnotempty="" placeholder="输入文章标题（1—50字）" maxlength="50" value="${bean.title}"/> 
	        <div class="msg-box">
                <div>
	            	<div id="errtxttitle" class="msg-weak msg-inline msg-error hd"><i></i><span id="errmsgtxttitle"></span></div>
	            	<div id="oktxttitle" class="msg-weak msg-inline msg-correct hd"></div>
                </div>
            </div>
            <br/>
            <label class="mb_30">文章副标题</label>
	        <input class="draft_input ml_35" type="text" name="shorttitle" placeholder="输入文章副标题（0—50字）" maxlength="50" value="${bean.shorttitle}"/> 
	        <br/>
	    	<label class="mb_30" >添加关键词<span class="red">*</span></label>
	        <input  class="draft_input ml_20" type="text" id="txtkeywords" name="keywords" value="${bean.keywords}" isnotempty="" placeholder="请输入关键词，关键词之间以空格隔开">
	        <div class="msg-box">
                <div>
	            	<div id="errtxtkeywords" class="msg-weak msg-inline msg-error hd"><i></i><span id="errmsgtxtkeywords"></span></div>
	            	<div id="oktxtkeywords" class="msg-weak msg-inline msg-correct hd"></div>
                </div>
            </div>
	        <br/>
	    	<label class="mb_30">标题图片</label>
	    	<a id="upload" href="javascript:showXiuXiu()" class="title_3_a">点此上传</a>
	        <div id="imgbox">
	        	<span id="altcontent"></span>
	        </div>
	        <div class="hd" id="imgshow" style="margin-left: 175px;">
	        	<img id="imgshow_big" src=''/>
	        </div>
	        <br/>
	        <input id="contributeimg" name="contributeimg" type="text" value="" class="hd"/>
	        <label class="mb_30">稿件正文<span class="red">*</span></label>
	        <div style="width:700px;display: inline-block;vertical-align: top;">
		    	<textarea class="draft_input2" id="content" name="content">${bean.content}</textarea>
		    </div>
	      <a class="draft_tg right" href="javascript:submit()">投稿</a>
      </div>
    </form>
  </div>
</div>
<script type="text/javascript">
   function submit(){
   		var content = CKEDITOR.instances.content.getData().trim();
   		var title = $("#txttitle").val();
   		if(title.length > 50 || 1 > title.length){
   			alert("标题请在1—50字之间");
   		}else if(content == ""){
	    	alert("稿件正文不能为空");
	    }else if($("[name='ischeckbox']:checked").val() != 0) {
			alert("请同意投稿协议");
		} else {
			$("#contribute").submit();			
		}
   }
</script>
</body>
</html>
