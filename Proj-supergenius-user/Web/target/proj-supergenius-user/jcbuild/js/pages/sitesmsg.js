$.extend({Object:{length:function(a){a=a||!1;return $.map(this,function(c){return a?!0:c}).length}}});var initPageState=0,siteMsgTotalCount=0,pageState=0;
$(function(){$(".newmessage").click(function(){window.open($(this).attr("href"))});$(".ignore").click(function(){var a=$(this).parent().data("channel"),a=ignoreMsgUrl[a],b=$(this);$.getJSON(a,function(a){a.ignoreResult&&(b.parent().remove(),a=b.parent().find("a b").text(),siteMsgTotalCount-=Number(a),$(".hasnews .number").html(siteMsgTotalCount),0==siteMsgTotalCount&&(pageState=0,$("#sitemsg").remove(),$(".hasnews").hide(),$(".nonews").show()))});return!1});$("#sitemsg div.nomsg").click(function(){return!1});
for(var a in msgUrl)$.getJSON(msgUrl[a],function(a){siteMsgTotalCount+=a.count;initChannelMsgCount(a);initSiteMsgStyle(a)});$(".newsnotice").bind("click",getSitesMsgCount)});function initChannelMsgCount(a){$("#sitemsg ul li").each(function(){$(this).data("channel")==a.channel&&$(this).find("a b").html(a.count)});initPageState++}
function initSiteMsgStyle(){initPageState==$.Object.length.call(msgUrl)&&($(".newsection .trangle").css("margin-left","40%"),0<siteMsgTotalCount?($(".hasnews .number").html(siteMsgTotalCount),$(".hasnews").show()):($("#sitemsg ul").remove(),getAndSetQuotes()))}
function getAndSetQuotes(){$.getJSON(quoteUrl,function(a){null!=a.author&&"undefined"!=a.author&&($("#sitemsg div.nomsg pre p").html(a.content),$("#sitemsg div.nomsg pre span").html("\u2014\u2014\u2014"+a.author));$(".newsection .trangle").css({"margin-left":"40%"});$("#sitemsg div.nomsg").show();$(".nonews").show()})}
function getSitesMsgCount(){var a=0,c=0,b;for(b in msgUrl)$.getJSON(msgUrl[b],function(b){a++;c+=b.count;setChannelMsgCount(b);setSiteMsgStyle();a==Object.keys(msgUrl).length&&(0==c&&!(1>$("#sitemsg ul").length))&&(getAndSetQuotes(),$("#sitemsg ul").remove(),$(".hasnews").hide(),$(".nonews").show())})}function setChannelMsgCount(a){$("#sitemsg ul li").each(function(){$(this).data("channel")==a.channel&&(0<a.count?$(this).find("a b").html(a.count):$(this).remove())});pageState++}
function setSiteMsgStyle(){pageState==$.Object.length.call(msgUrl)&&0<siteMsgTotalCount?$("#sitemsg ul").show():pageState==$.Object.length.call(msgUrl)&&$("#sitemsg div.nomsg").show();$("#sitemsg").removeClass("hd")};
