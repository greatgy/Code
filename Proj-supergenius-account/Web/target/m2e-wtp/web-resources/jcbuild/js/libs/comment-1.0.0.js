(function(b){function d(a){var c=a.data;b.get(getNoCachePath(g.baseuri+"/ajax/prize/"+c.uid),{},function(a){a?(a=b(".prizecounter",c.obj).html(),a=a.substring(1,a.length-1),b(".prizecounter",c.obj).html("("+(parseInt(a)+1)+")"),b(".prizecounter",c.obj).siblings("img").each(function(){b(this).data("isprize",!0);prizeBindEvetEach(this)})):(a=b(".prizecounter",c.obj).html(),a=a.substring(1,a.length-1),b(".prizecounter",c.obj).html("("+(parseInt(a)-1)+")"),b(".prizecounter",c.obj).siblings("img").each(function(){b(this).data("isprize",
!1);prizeBindEvetEach(this)}))})}b.fn.prize=function(a){a=b.extend({},{uid:"",counter:{},prizeClickHandler:d},a);0<b(this).length&&(a.uid=b(this).attr("id").replace("btnprize",""),a.counter=b(b(this).data("counter")),a.obj=this,b(this).bind("click",a,a.prizeClickHandler))}})(jQuery);function prizeBindEvent(){$("a[id^='btnprize'] img").each(function(){prizeBindEvetEach(this)})}
function prizeBindEvetEach(b){var d=$(b).data("isprize");d?($(b).attr("src",g.baseimg+"/imgs/default/heart_01.png"),$(b).attr("title","\u53d6\u6d88\u8d5e")):($(b).attr("src",g.baseimg+"/imgs/default/heart_02.png"),$(b).attr("title","\u70b9\u51fb\u8d5e"));d?($(b).unbind("mouseover"),$(b).unbind("mouseleave")):($(b).bind("mouseover",function(){$(b).attr("src",g.baseimg+"/imgs/default/heart_01.png")}),$(b).bind("mouseleave",function(){$(this).attr("src",g.baseimg+"/imgs/default/heart_02.png")}))}
(function(b){function d(a){a=a.data;1==a.target.data("flag")?(a.target.addClass("hd"),a.target.data("flag",0)):(a.target.data("flag",1),a.target.removeClass("hd"),b("#box"+a.uid).removeClass("hd"),a.target.html(b("#sharebox").clone(!0)),b("#sharebox",a.target).removeClass("hd"),b("textarea",a.target).val(b(".content"+a.uid).text().trim()),b("textarea",a.target).data("uri",b(this).data("uri")),b("textarea",a.target).autosize(),computeTextBoxWordsCount(b(".txtbox textarea",a.target),b("#counter",a.target)),
b(".btnsubmit",a.target).bind("click",a,a.btnsubmitClickHandler))}b.fn.share=function(a){a=b.extend({},{uid:"",mainlink:null,counter:{},target:{},maxlength:300,shareClickHandler:d,btnsubmitClickHandler:defaultBtnsubmitClickHandler},a);0<b(this).length&&(a.uid=b(this).attr("id").replace("btnshare",""),a.mainlink=b(this),a.counter=b(this).children("sup"),a.target=b("#box"+a.uid+" .comments"),b(this).bind("click",a,a.shareClickHandler))}})(jQuery);
$(function(){$("a[id^='btnprize']").each(function(){$(this).prize()});$("a[id^='btnshare']").each(function(){$(this).share()})});function registerPraise(){$(".reply a[id^='btnprize']").each(function(){$(this).prize()});prizeBindEvent()};
