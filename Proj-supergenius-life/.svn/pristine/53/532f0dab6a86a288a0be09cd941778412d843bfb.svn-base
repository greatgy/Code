[#ftl]
[#import "/WEB-INF/FtlLib/Macro/Public.ftl" as p]
<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>${title!'天才人生——行万里路'}</title>
	<meta name="Keywords" content="天才人生，行万里路" />
	<meta name="Description" content="天才人生，行万里路" />
	<link rel="stylesheet" href="${basecss}/css/default/index.css">
	<script type="text/javascript" src="${basejs}/js/pages/scroll.js"></script>
</head>
<body>
	<div class="map">
		<img src="${baseimg}/imgs/default/map.png" alt="中国地图" title="中国地图" />
	</div>
	<div class="footprint">
		<ul class="judgement">
			<li class="curjudge">最新</li>
			<li>最热</li>
		</ul>
		[#if me??]
			<a class="publishBtn" href="${base}/addproblem/${cid}">添加足迹</a>
		[#else]
			<a class="publishBtn pop-up" >添加足迹</a>
		[/#if]
		<ul class="tabBox footbox">
			[#if problemList??]
			[#list problemList as item]
				<li>
					<a href="${base}/problem/detail/${(item.cid)?c}/${(item.oid)?c}" class="articleTitle">
						${item.title}
						<span class="location"><img src="${baseimg}/imgs/default/location.png" alt="位置" title="位置" />${item.placename}</span>
					</a>
					<p class="descripe">
						[#if item.content==""]
						[#else]
							[@p.TrimSubstring content="${item.content}" mylength=50 /]
						[/#if]
					</p>
					<div class="timepiece">
						<span class="time">
							[@p.mytime datetime="${item.createtimeStr}"/]
						</span>
						<div class="operateBox">
							<a href="${base}/problem/detail/${(item.cid)?c}/${(item.oid)?c}" class="littleicon">
								<img src="${baseimg}/imgs/default/clickcount.png">
								${item.clickcount}
							</a>
							<a href="${base}/problem/detail/${(item.cid)?c}/${(item.oid)?c}" class="littleicon">
								<img src="${baseimg}/imgs/default/heart.png">
								${item.commentscount}
							</a>
						</div>
					</div>
				</li>
			[/#list]
			[/#if]
		</ul>
	</div>
	<script>
		$(function(){
			$.fn.scrollHandle({
				obj: window,
				fun: loadmore
			})
		})
		
		var prePage = 2;
		var pagenum = 3;
		// 加载更多文章
		function loadmore() {
			var	url = "${base}/ajax/first/problem";
			if(prePage != pagenum) {
			    prePage = pagenum;
				$.get(url, {pagenum:pagenum, cid:${cid}, ismember:0}, function(data){
					if(data.trim() == ""){// 没有更多内容
						$(window).unbind("scroll", defaultScrollHandler);
						return false;
					}
					$(".tabBox").append(data);
					pagenum+=1;
				});
			}
		}
	</script>
</body>
</html>